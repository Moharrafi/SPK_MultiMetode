{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/decision-support-system/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient }\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],\n  })\n\nif (process.env.NODE_ENV !== 'production') {\n  globalForPrisma.prisma = prisma\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B"}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/decision-support-system/lib/settings-data.ts"],"sourcesContent":["export interface DashboardWidgets {\n  statsCards: boolean\n  methodChart: boolean\n  quickActions: boolean\n  topRanking: boolean\n  recentActivity: boolean\n  systemStatus: boolean\n}\n\nexport interface BackupSettings {\n  enabled: boolean\n  frequency: 'daily' | 'weekly' | 'monthly'\n  lastBackup: Date | string | null\n  nextBackup: Date | string | null\n}\n\nexport interface ReportSettings {\n  organizationName: string\n  location: string\n  leaderName: string\n  leaderTitle: string\n  logoUrl: string\n}\n\nexport interface AppSettings {\n  appName: string\n  appSubtitle: string\n  appLogoUrl: string\n}\n\nexport interface SettingsSnapshot {\n  dashboardWidgets: DashboardWidgets\n  backupSettings: BackupSettings\n  reportSettings: ReportSettings\n  appSettings: AppSettings\n}\n\nexport type SettingsKey = keyof SettingsSnapshot\n\nexport const SETTINGS_KEYS: SettingsKey[] = ['dashboardWidgets', 'backupSettings', 'reportSettings', 'appSettings']\n\nexport const defaultDashboardWidgets: DashboardWidgets = {\n  statsCards: true,\n  methodChart: true,\n  quickActions: true,\n  topRanking: true,\n  recentActivity: true,\n  systemStatus: true,\n}\n\nexport const defaultBackupSettings: BackupSettings = {\n  enabled: true,\n  frequency: 'weekly',\n  lastBackup: null,\n  nextBackup: null,\n}\n\nexport const defaultReportSettings: ReportSettings = {\n  organizationName: 'Sistem Pendukung Keputusan Multi Metode',\n  location: 'Jakarta',\n  leaderName: 'Nama Ketua',\n  leaderTitle: 'NIP. 123456789',\n  logoUrl: '',\n}\n\nexport const defaultAppSettings: AppSettings = {\n  appName: 'SPK Multi-Metode',\n  appSubtitle: 'SAW | AHP | TOPSIS',\n  appLogoUrl: '',\n}\n\nexport function getDefaultSettings(): SettingsSnapshot {\n  return {\n    dashboardWidgets: { ...defaultDashboardWidgets },\n    backupSettings: { ...defaultBackupSettings },\n    reportSettings: { ...defaultReportSettings },\n    appSettings: { ...defaultAppSettings },\n  }\n}\n\nexport function calculateNextBackup(frequency: BackupSettings['frequency'], from: Date = new Date()): Date {\n  const next = new Date(from)\n  switch (frequency) {\n    case 'daily':\n      next.setDate(next.getDate() + 1)\n      break\n    case 'weekly':\n      next.setDate(next.getDate() + 7)\n      break\n    case 'monthly':\n      next.setMonth(next.getMonth() + 1)\n      break\n  }\n  return next\n}\n\nexport function deserializeBackupSettings(data?: Partial<BackupSettings> | null): BackupSettings {\n  const merged = { ...defaultBackupSettings, ...(data || {}) }\n  return {\n    ...merged,\n    lastBackup: merged.lastBackup ? new Date(merged.lastBackup) : null,\n    nextBackup: merged.nextBackup ? new Date(merged.nextBackup) : null,\n  }\n}\n\nexport function serializeBackupSettings(settings: BackupSettings) {\n  return {\n    ...settings,\n    lastBackup: settings.lastBackup ? new Date(settings.lastBackup).toISOString() : null,\n    nextBackup: settings.nextBackup ? new Date(settings.nextBackup).toISOString() : null,\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAuCO,MAAM,gBAA+B;IAAC;IAAoB;IAAkB;IAAkB;CAAc;AAE5G,MAAM,0BAA4C;IACvD,YAAY;IACZ,aAAa;IACb,cAAc;IACd,YAAY;IACZ,gBAAgB;IAChB,cAAc;AAChB;AAEO,MAAM,wBAAwC;IACnD,SAAS;IACT,WAAW;IACX,YAAY;IACZ,YAAY;AACd;AAEO,MAAM,wBAAwC;IACnD,kBAAkB;IAClB,UAAU;IACV,YAAY;IACZ,aAAa;IACb,SAAS;AACX;AAEO,MAAM,qBAAkC;IAC7C,SAAS;IACT,aAAa;IACb,YAAY;AACd;AAEO,SAAS;IACd,OAAO;QACL,kBAAkB;YAAE,GAAG,uBAAuB;QAAC;QAC/C,gBAAgB;YAAE,GAAG,qBAAqB;QAAC;QAC3C,gBAAgB;YAAE,GAAG,qBAAqB;QAAC;QAC3C,aAAa;YAAE,GAAG,kBAAkB;QAAC;IACvC;AACF;AAEO,SAAS,oBAAoB,SAAsC,EAAE,OAAa,IAAI,MAAM;IACjG,MAAM,OAAO,IAAI,KAAK;IACtB,OAAQ;QACN,KAAK;YACH,KAAK,OAAO,CAAC,KAAK,OAAO,KAAK;YAC9B;QACF,KAAK;YACH,KAAK,OAAO,CAAC,KAAK,OAAO,KAAK;YAC9B;QACF,KAAK;YACH,KAAK,QAAQ,CAAC,KAAK,QAAQ,KAAK;YAChC;IACJ;IACA,OAAO;AACT;AAEO,SAAS,0BAA0B,IAAqC;IAC7E,MAAM,SAAS;QAAE,GAAG,qBAAqB;QAAE,GAAI,QAAQ,CAAC,CAAC;IAAE;IAC3D,OAAO;QACL,GAAG,MAAM;QACT,YAAY,OAAO,UAAU,GAAG,IAAI,KAAK,OAAO,UAAU,IAAI;QAC9D,YAAY,OAAO,UAAU,GAAG,IAAI,KAAK,OAAO,UAAU,IAAI;IAChE;AACF;AAEO,SAAS,wBAAwB,QAAwB;IAC9D,OAAO;QACL,GAAG,QAAQ;QACX,YAAY,SAAS,UAAU,GAAG,IAAI,KAAK,SAAS,UAAU,EAAE,WAAW,KAAK;QAChF,YAAY,SAAS,UAAU,GAAG,IAAI,KAAK,SAAS,UAAU,EAAE,WAAW,KAAK;IAClF;AACF"}},
    {"offset": {"line": 190, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/decision-support-system/app/api/backup/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport { promises as fs } from 'fs'\nimport path from 'path'\n\nimport { prisma } from '@/lib/db'\nimport { SETTINGS_KEYS, SettingsKey, getDefaultSettings } from '@/lib/settings-data'\n\nconst SETTINGS_FILE = path.join(process.cwd(), 'settings-cache.json')\n\nconst readSettingsFile = async () => {\n  try {\n    const raw = await fs.readFile(SETTINGS_FILE, 'utf8')\n    return JSON.parse(raw) as Partial<Record<SettingsKey, unknown>>\n  } catch {\n    return null\n  }\n}\n\nconst defaultMetodeConfig = [\n  { nama: 'SAW', aktif: true, bobot: 1 },\n  { nama: 'AHP', aktif: true, bobot: 1 },\n  { nama: 'TOPSIS', aktif: true, bobot: 1 },\n]\n\nexport async function POST() {\n  try {\n    const timestamp = new Date()\n    const [alternatif, kriteria, subKriteria, penilaian, pairwiseComparisons] = await Promise.all([\n      prisma.alternatif.findMany({ orderBy: { createdAt: 'asc' } }),\n      prisma.kriteria.findMany({ orderBy: { createdAt: 'asc' } }),\n      prisma.subKriteria.findMany(),\n      prisma.penilaian.findMany(),\n      prisma.pairwiseComparison.findMany(),\n    ])\n    let metodeConfig = await prisma.metodeConfig.findMany({ orderBy: { nama: 'asc' } })\n    if (metodeConfig.length === 0) {\n      metodeConfig = await prisma.$transaction(\n        defaultMetodeConfig.map((config) => prisma.metodeConfig.create({ data: config })),\n      )\n    }\n\n    const defaults = getDefaultSettings()\n    const cached = (await readSettingsFile()) as Partial<typeof defaults> | null\n    const settingSnapshot: typeof defaults = { ...defaults }\n\n    if (cached) {\n      for (const key of SETTINGS_KEYS) {\n        if (cached[key]) {\n          settingSnapshot[key] = cached[key] as (typeof defaults)[SettingsKey]\n        }\n      }\n    }\n\n    const contents = {\n      generatedAt: timestamp.toISOString(),\n      metadata: {\n        alternatifCount: alternatif.length,\n        kriteriaCount: kriteria.length,\n        penilaianCount: penilaian.length,\n        metodeCount: metodeConfig.length,\n      },\n      data: {\n        alternatif,\n        kriteria,\n        subKriteria,\n        penilaian,\n        pairwiseComparisons,\n        metodeConfig,\n        settings: settingSnapshot,\n      },\n    }\n\n    const fileName = `backup-spk-${timestamp.toISOString().replace(/[:.]/g, '-')}.json`\n\n    return NextResponse.json({ fileName, contents })\n  } catch (error) {\n    console.error('Failed to generate backup', error)\n    return NextResponse.json({ error: 'Gagal membuat backup' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAEA;AACA;;;;;;AAEA,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAE/C,MAAM,mBAAmB;IACvB,IAAI;QACF,MAAM,MAAM,MAAM,yGAAE,CAAC,QAAQ,CAAC,eAAe;QAC7C,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEA,MAAM,sBAAsB;IAC1B;QAAE,MAAM;QAAO,OAAO;QAAM,OAAO;IAAE;IACrC;QAAE,MAAM;QAAO,OAAO;QAAM,OAAO;IAAE;IACrC;QAAE,MAAM;QAAU,OAAO;QAAM,OAAO;IAAE;CACzC;AAEM,eAAe;IACpB,IAAI;QACF,MAAM,YAAY,IAAI;QACtB,MAAM,CAAC,YAAY,UAAU,aAAa,WAAW,oBAAoB,GAAG,MAAM,QAAQ,GAAG,CAAC;YAC5F,qHAAM,CAAC,UAAU,CAAC,QAAQ,CAAC;gBAAE,SAAS;oBAAE,WAAW;gBAAM;YAAE;YAC3D,qHAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;gBAAE,SAAS;oBAAE,WAAW;gBAAM;YAAE;YACzD,qHAAM,CAAC,WAAW,CAAC,QAAQ;YAC3B,qHAAM,CAAC,SAAS,CAAC,QAAQ;YACzB,qHAAM,CAAC,kBAAkB,CAAC,QAAQ;SACnC;QACD,IAAI,eAAe,MAAM,qHAAM,CAAC,YAAY,CAAC,QAAQ,CAAC;YAAE,SAAS;gBAAE,MAAM;YAAM;QAAE;QACjF,IAAI,aAAa,MAAM,KAAK,GAAG;YAC7B,eAAe,MAAM,qHAAM,CAAC,YAAY,CACtC,oBAAoB,GAAG,CAAC,CAAC,SAAW,qHAAM,CAAC,YAAY,CAAC,MAAM,CAAC;oBAAE,MAAM;gBAAO;QAElF;QAEA,MAAM,WAAW,IAAA,+IAAkB;QACnC,MAAM,SAAU,MAAM;QACtB,MAAM,kBAAmC;YAAE,GAAG,QAAQ;QAAC;QAEvD,IAAI,QAAQ;YACV,KAAK,MAAM,OAAO,0IAAa,CAAE;gBAC/B,IAAI,MAAM,CAAC,IAAI,EAAE;oBACf,eAAe,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI;gBACpC;YACF;QACF;QAEA,MAAM,WAAW;YACf,aAAa,UAAU,WAAW;YAClC,UAAU;gBACR,iBAAiB,WAAW,MAAM;gBAClC,eAAe,SAAS,MAAM;gBAC9B,gBAAgB,UAAU,MAAM;gBAChC,aAAa,aAAa,MAAM;YAClC;YACA,MAAM;gBACJ;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA,UAAU;YACZ;QACF;QAEA,MAAM,WAAW,CAAC,WAAW,EAAE,UAAU,WAAW,GAAG,OAAO,CAAC,SAAS,KAAK,KAAK,CAAC;QAEnF,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE;YAAU;QAAS;IAChD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF"}}]
}