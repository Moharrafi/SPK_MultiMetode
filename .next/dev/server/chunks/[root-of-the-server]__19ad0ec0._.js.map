{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/decision-support-system/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient }\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],\n  })\n\nif (process.env.NODE_ENV !== 'production') {\n  globalForPrisma.prisma = prisma\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/decision-support-system/lib/settings-data.ts"],"sourcesContent":["export interface DashboardWidgets {\n  statsCards: boolean\n  methodChart: boolean\n  quickActions: boolean\n  topRanking: boolean\n  recentActivity: boolean\n  systemStatus: boolean\n}\n\nexport interface BackupSettings {\n  enabled: boolean\n  frequency: 'daily' | 'weekly' | 'monthly'\n  lastBackup: Date | string | null\n  nextBackup: Date | string | null\n}\n\nexport interface ReportSettings {\n  organizationName: string\n  location: string\n  leaderName: string\n  leaderTitle: string\n  logoUrl: string\n}\n\nexport interface AppSettings {\n  appName: string\n  appSubtitle: string\n  appLogoUrl: string\n}\n\nexport interface SettingsSnapshot {\n  dashboardWidgets: DashboardWidgets\n  backupSettings: BackupSettings\n  reportSettings: ReportSettings\n  appSettings: AppSettings\n}\n\nexport type SettingsKey = keyof SettingsSnapshot\n\nexport const SETTINGS_KEYS: SettingsKey[] = ['dashboardWidgets', 'backupSettings', 'reportSettings', 'appSettings']\n\nexport const defaultDashboardWidgets: DashboardWidgets = {\n  statsCards: true,\n  methodChart: true,\n  quickActions: true,\n  topRanking: true,\n  recentActivity: true,\n  systemStatus: true,\n}\n\nexport const defaultBackupSettings: BackupSettings = {\n  enabled: true,\n  frequency: 'weekly',\n  lastBackup: null,\n  nextBackup: null,\n}\n\nexport const defaultReportSettings: ReportSettings = {\n  organizationName: 'Sistem Pendukung Keputusan Multi Metode',\n  location: 'Jakarta',\n  leaderName: 'Nama Ketua',\n  leaderTitle: 'NIP. 123456789',\n  logoUrl: '',\n}\n\nexport const defaultAppSettings: AppSettings = {\n  appName: 'SPK Multi-Metode',\n  appSubtitle: 'SAW | AHP | TOPSIS',\n  appLogoUrl: '',\n}\n\nexport function getDefaultSettings(): SettingsSnapshot {\n  return {\n    dashboardWidgets: { ...defaultDashboardWidgets },\n    backupSettings: { ...defaultBackupSettings },\n    reportSettings: { ...defaultReportSettings },\n    appSettings: { ...defaultAppSettings },\n  }\n}\n\nexport function calculateNextBackup(frequency: BackupSettings['frequency'], from: Date = new Date()): Date {\n  const next = new Date(from)\n  switch (frequency) {\n    case 'daily':\n      next.setDate(next.getDate() + 1)\n      break\n    case 'weekly':\n      next.setDate(next.getDate() + 7)\n      break\n    case 'monthly':\n      next.setMonth(next.getMonth() + 1)\n      break\n  }\n  return next\n}\n\nexport function deserializeBackupSettings(data?: Partial<BackupSettings> | null): BackupSettings {\n  const merged = { ...defaultBackupSettings, ...(data || {}) }\n  return {\n    ...merged,\n    lastBackup: merged.lastBackup ? new Date(merged.lastBackup) : null,\n    nextBackup: merged.nextBackup ? new Date(merged.nextBackup) : null,\n  }\n}\n\nexport function serializeBackupSettings(settings: BackupSettings) {\n  return {\n    ...settings,\n    lastBackup: settings.lastBackup ? new Date(settings.lastBackup).toISOString() : null,\n    nextBackup: settings.nextBackup ? new Date(settings.nextBackup).toISOString() : null,\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAuCO,MAAM,gBAA+B;IAAC;IAAoB;IAAkB;IAAkB;CAAc;AAE5G,MAAM,0BAA4C;IACvD,YAAY;IACZ,aAAa;IACb,cAAc;IACd,YAAY;IACZ,gBAAgB;IAChB,cAAc;AAChB;AAEO,MAAM,wBAAwC;IACnD,SAAS;IACT,WAAW;IACX,YAAY;IACZ,YAAY;AACd;AAEO,MAAM,wBAAwC;IACnD,kBAAkB;IAClB,UAAU;IACV,YAAY;IACZ,aAAa;IACb,SAAS;AACX;AAEO,MAAM,qBAAkC;IAC7C,SAAS;IACT,aAAa;IACb,YAAY;AACd;AAEO,SAAS;IACd,OAAO;QACL,kBAAkB;YAAE,GAAG,uBAAuB;QAAC;QAC/C,gBAAgB;YAAE,GAAG,qBAAqB;QAAC;QAC3C,gBAAgB;YAAE,GAAG,qBAAqB;QAAC;QAC3C,aAAa;YAAE,GAAG,kBAAkB;QAAC;IACvC;AACF;AAEO,SAAS,oBAAoB,SAAsC,EAAE,OAAa,IAAI,MAAM;IACjG,MAAM,OAAO,IAAI,KAAK;IACtB,OAAQ;QACN,KAAK;YACH,KAAK,OAAO,CAAC,KAAK,OAAO,KAAK;YAC9B;QACF,KAAK;YACH,KAAK,OAAO,CAAC,KAAK,OAAO,KAAK;YAC9B;QACF,KAAK;YACH,KAAK,QAAQ,CAAC,KAAK,QAAQ,KAAK;YAChC;IACJ;IACA,OAAO;AACT;AAEO,SAAS,0BAA0B,IAAqC;IAC7E,MAAM,SAAS;QAAE,GAAG,qBAAqB;QAAE,GAAI,QAAQ,CAAC,CAAC;IAAE;IAC3D,OAAO;QACL,GAAG,MAAM;QACT,YAAY,OAAO,UAAU,GAAG,IAAI,KAAK,OAAO,UAAU,IAAI;QAC9D,YAAY,OAAO,UAAU,GAAG,IAAI,KAAK,OAAO,UAAU,IAAI;IAChE;AACF;AAEO,SAAS,wBAAwB,QAAwB;IAC9D,OAAO;QACL,GAAG,QAAQ;QACX,YAAY,SAAS,UAAU,GAAG,IAAI,KAAK,SAAS,UAAU,EAAE,WAAW,KAAK;QAChF,YAAY,SAAS,UAAU,GAAG,IAAI,KAAK,SAAS,UAAU,EAAE,WAAW,KAAK;IAClF;AACF"}},
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/decision-support-system/app/api/settings/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\n\nimport { prisma } from '@/lib/db'\nimport {\n  SETTINGS_KEYS,\n  SettingsKey,\n  getDefaultSettings,\n} from '@/lib/settings-data'\n\nexport async function GET() {\n  try {\n    const defaults = getDefaultSettings()\n    type SettingsResponse = typeof defaults\n    const records = await prisma.setting.findMany()\n    const data: SettingsResponse = { ...defaults }\n\n    for (const record of records) {\n      if (SETTINGS_KEYS.includes(record.key as SettingsKey)) {\n        data[record.key as SettingsKey] = record.data as SettingsResponse[SettingsKey]\n      }\n    }\n\n    const missingKeys = SETTINGS_KEYS.filter((key) => !records.some((record) => record.key === key))\n    if (missingKeys.length) {\n      await Promise.all(\n        missingKeys.map((key) =>\n          prisma.setting.create({\n            data: {\n              key,\n              data: defaults[key],\n            },\n          }),\n        ),\n      )\n    }\n\n    return NextResponse.json(data)\n  } catch (error) {\n    console.error('Failed to load settings from database', error)\n    return NextResponse.json({ error: 'Failed to load settings' }, { status: 500 })\n  }\n}\n\nexport async function PATCH(request: Request) {\n  try {\n    const body = await request.json()\n    const key = body?.key as SettingsKey\n    const settingData = body?.data\n\n    if (!key || settingData === undefined) {\n      return NextResponse.json({ error: 'Key and data are required' }, { status: 400 })\n    }\n\n    if (!SETTINGS_KEYS.includes(key)) {\n      return NextResponse.json({ error: 'Invalid setting key' }, { status: 400 })\n    }\n\n    const updated = await prisma.setting.upsert({\n      where: { key },\n      update: { data: settingData },\n      create: { key, data: settingData },\n    })\n\n    return NextResponse.json(updated.data)\n  } catch (error) {\n    console.error('Failed to update settings', error)\n    return NextResponse.json({ error: 'Failed to update settings' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAEA;AACA;;;;AAMO,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,IAAA,+IAAkB;QAEnC,MAAM,UAAU,MAAM,qHAAM,CAAC,OAAO,CAAC,QAAQ;QAC7C,MAAM,OAAyB;YAAE,GAAG,QAAQ;QAAC;QAE7C,KAAK,MAAM,UAAU,QAAS;YAC5B,IAAI,0IAAa,CAAC,QAAQ,CAAC,OAAO,GAAG,GAAkB;gBACrD,IAAI,CAAC,OAAO,GAAG,CAAgB,GAAG,OAAO,IAAI;YAC/C;QACF;QAEA,MAAM,cAAc,0IAAa,CAAC,MAAM,CAAC,CAAC,MAAQ,CAAC,QAAQ,IAAI,CAAC,CAAC,SAAW,OAAO,GAAG,KAAK;QAC3F,IAAI,YAAY,MAAM,EAAE;YACtB,MAAM,QAAQ,GAAG,CACf,YAAY,GAAG,CAAC,CAAC,MACf,qHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;oBACpB,MAAM;wBACJ;wBACA,MAAM,QAAQ,CAAC,IAAI;oBACrB;gBACF;QAGN;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yCAAyC;QACvD,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACF;AAEO,eAAe,MAAM,OAAgB;IAC1C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,MAAM,MAAM;QAClB,MAAM,cAAc,MAAM;QAE1B,IAAI,CAAC,OAAO,gBAAgB,WAAW;YACrC,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,IAAI,CAAC,0IAAa,CAAC,QAAQ,CAAC,MAAM;YAChC,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,UAAU,MAAM,qHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;YAC1C,OAAO;gBAAE;YAAI;YACb,QAAQ;gBAAE,MAAM;YAAY;YAC5B,QAAQ;gBAAE;gBAAK,MAAM;YAAY;QACnC;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC,QAAQ,IAAI;IACvC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACF"}}]
}