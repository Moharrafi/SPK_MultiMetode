{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/decision-support-system/lib/settings-data.ts"],"sourcesContent":["export interface DashboardWidgets {\n  statsCards: boolean\n  methodChart: boolean\n  quickActions: boolean\n  topRanking: boolean\n  recentActivity: boolean\n  systemStatus: boolean\n}\n\nexport interface BackupSettings {\n  enabled: boolean\n  frequency: 'daily' | 'weekly' | 'monthly'\n  lastBackup: Date | string | null\n  nextBackup: Date | string | null\n}\n\nexport interface ReportSettings {\n  organizationName: string\n  location: string\n  leaderName: string\n  leaderTitle: string\n  logoUrl: string\n}\n\nexport interface AppSettings {\n  appName: string\n  appSubtitle: string\n  appLogoUrl: string\n}\n\nexport interface SettingsSnapshot {\n  dashboardWidgets: DashboardWidgets\n  backupSettings: BackupSettings\n  reportSettings: ReportSettings\n  appSettings: AppSettings\n}\n\nexport type SettingsKey = keyof SettingsSnapshot\n\nexport const SETTINGS_KEYS: SettingsKey[] = ['dashboardWidgets', 'backupSettings', 'reportSettings', 'appSettings']\n\nexport const defaultDashboardWidgets: DashboardWidgets = {\n  statsCards: true,\n  methodChart: true,\n  quickActions: true,\n  topRanking: true,\n  recentActivity: true,\n  systemStatus: true,\n}\n\nexport const defaultBackupSettings: BackupSettings = {\n  enabled: true,\n  frequency: 'weekly',\n  lastBackup: null,\n  nextBackup: null,\n}\n\nexport const defaultReportSettings: ReportSettings = {\n  organizationName: 'Sistem Pendukung Keputusan Multi Metode',\n  location: 'Jakarta',\n  leaderName: 'Nama Ketua',\n  leaderTitle: 'NIP. 123456789',\n  logoUrl: '',\n}\n\nexport const defaultAppSettings: AppSettings = {\n  appName: 'SPK Multi-Metode',\n  appSubtitle: 'SAW | AHP | TOPSIS',\n  appLogoUrl: '',\n}\n\nexport function getDefaultSettings(): SettingsSnapshot {\n  return {\n    dashboardWidgets: { ...defaultDashboardWidgets },\n    backupSettings: { ...defaultBackupSettings },\n    reportSettings: { ...defaultReportSettings },\n    appSettings: { ...defaultAppSettings },\n  }\n}\n\nexport function calculateNextBackup(frequency: BackupSettings['frequency'], from: Date = new Date()): Date {\n  const next = new Date(from)\n  switch (frequency) {\n    case 'daily':\n      next.setDate(next.getDate() + 1)\n      break\n    case 'weekly':\n      next.setDate(next.getDate() + 7)\n      break\n    case 'monthly':\n      next.setMonth(next.getMonth() + 1)\n      break\n  }\n  return next\n}\n\nexport function deserializeBackupSettings(data?: Partial<BackupSettings> | null): BackupSettings {\n  const merged = { ...defaultBackupSettings, ...(data || {}) }\n  return {\n    ...merged,\n    lastBackup: merged.lastBackup ? new Date(merged.lastBackup) : null,\n    nextBackup: merged.nextBackup ? new Date(merged.nextBackup) : null,\n  }\n}\n\nexport function serializeBackupSettings(settings: BackupSettings) {\n  return {\n    ...settings,\n    lastBackup: settings.lastBackup ? new Date(settings.lastBackup).toISOString() : null,\n    nextBackup: settings.nextBackup ? new Date(settings.nextBackup).toISOString() : null,\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAuCO,MAAM,gBAA+B;IAAC;IAAoB;IAAkB;IAAkB;CAAc;AAE5G,MAAM,0BAA4C;IACvD,YAAY;IACZ,aAAa;IACb,cAAc;IACd,YAAY;IACZ,gBAAgB;IAChB,cAAc;AAChB;AAEO,MAAM,wBAAwC;IACnD,SAAS;IACT,WAAW;IACX,YAAY;IACZ,YAAY;AACd;AAEO,MAAM,wBAAwC;IACnD,kBAAkB;IAClB,UAAU;IACV,YAAY;IACZ,aAAa;IACb,SAAS;AACX;AAEO,MAAM,qBAAkC;IAC7C,SAAS;IACT,aAAa;IACb,YAAY;AACd;AAEO,SAAS;IACd,OAAO;QACL,kBAAkB;YAAE,GAAG,uBAAuB;QAAC;QAC/C,gBAAgB;YAAE,GAAG,qBAAqB;QAAC;QAC3C,gBAAgB;YAAE,GAAG,qBAAqB;QAAC;QAC3C,aAAa;YAAE,GAAG,kBAAkB;QAAC;IACvC;AACF;AAEO,SAAS,oBAAoB,SAAsC,EAAE,OAAa,IAAI,MAAM;IACjG,MAAM,OAAO,IAAI,KAAK;IACtB,OAAQ;QACN,KAAK;YACH,KAAK,OAAO,CAAC,KAAK,OAAO,KAAK;YAC9B;QACF,KAAK;YACH,KAAK,OAAO,CAAC,KAAK,OAAO,KAAK;YAC9B;QACF,KAAK;YACH,KAAK,QAAQ,CAAC,KAAK,QAAQ,KAAK;YAChC;IACJ;IACA,OAAO;AACT;AAEO,SAAS,0BAA0B,IAAqC;IAC7E,MAAM,SAAS;QAAE,GAAG,qBAAqB;QAAE,GAAI,QAAQ,CAAC,CAAC;IAAE;IAC3D,OAAO;QACL,GAAG,MAAM;QACT,YAAY,OAAO,UAAU,GAAG,IAAI,KAAK,OAAO,UAAU,IAAI;QAC9D,YAAY,OAAO,UAAU,GAAG,IAAI,KAAK,OAAO,UAAU,IAAI;IAChE;AACF;AAEO,SAAS,wBAAwB,QAAwB;IAC9D,OAAO;QACL,GAAG,QAAQ;QACX,YAAY,SAAS,UAAU,GAAG,IAAI,KAAK,SAAS,UAAU,EAAE,WAAW,KAAK;QAChF,YAAY,SAAS,UAAU,GAAG,IAAI,KAAK,SAAS,UAAU,EAAE,WAAW,KAAK;IAClF;AACF"}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/decision-support-system/app/api/settings/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport { promises as fs } from 'fs'\nimport path from 'path'\n\nimport { SETTINGS_KEYS, SettingsKey, SettingsSnapshot, getDefaultSettings } from '@/lib/settings-data'\n\nconst SETTINGS_FILE = path.join(process.cwd(), 'settings-cache.json')\n\nconst readSettingsFile = async () => {\n  try {\n    const raw = await fs.readFile(SETTINGS_FILE, 'utf8')\n    return JSON.parse(raw) as Record<string, unknown>\n  } catch (error) {\n    return null\n  }\n}\n\nconst writeSettingsFile = async (data: Record<string, unknown>) => {\n  await fs.writeFile(SETTINGS_FILE, JSON.stringify(data, null, 2), 'utf8')\n}\n\nconst isRecord = (value: unknown): value is Record<string, unknown> =>\n  typeof value === 'object' && value !== null && !Array.isArray(value)\n\nexport async function GET() {\n  try {\n    const defaults = getDefaultSettings()\n    const stored = (await readSettingsFile()) || {}\n    const response = { ...defaults }\n\n    for (const key of SETTINGS_KEYS) {\n      if (stored[key]) {\n        response[key as SettingsKey] = stored[key] as (typeof defaults)[SettingsKey]\n      }\n    }\n\n    return NextResponse.json(response)\n  } catch (error) {\n    console.error('Failed to load settings from file', error)\n    return NextResponse.json(getDefaultSettings())\n  }\n}\n\nexport async function PATCH(request: Request) {\n  try {\n    const body = await request.json()\n    const key = body?.key as SettingsKey\n    const settingData = body?.data\n\n    if (!key || settingData === undefined) {\n      return NextResponse.json({ error: 'Key and data are required' }, { status: 400 })\n    }\n\n    if (!SETTINGS_KEYS.includes(key)) {\n      return NextResponse.json({ error: 'Invalid setting key' }, { status: 400 })\n    }\n\n    const defaults = getDefaultSettings()\n    const stored = ((await readSettingsFile()) || {}) as Partial<SettingsSnapshot>\n    const merged: SettingsSnapshot = { ...defaults, ...stored }\n    const currentValue = merged[key]\n    const nextValue =\n      isRecord(currentValue) && isRecord(settingData) ? { ...currentValue, ...settingData } : settingData\n\n    const next: SettingsSnapshot = { ...merged, [key]: nextValue as SettingsSnapshot[typeof key] }\n    await writeSettingsFile(next as Record<string, unknown>)\n\n    return NextResponse.json(nextValue)\n  } catch (error) {\n    console.error('Failed to update settings file', error)\n    return NextResponse.json({ error: 'Failed to update settings' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAE/C,MAAM,mBAAmB;IACvB,IAAI;QACF,MAAM,MAAM,MAAM,yGAAE,CAAC,QAAQ,CAAC,eAAe;QAC7C,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEA,MAAM,oBAAoB,OAAO;IAC/B,MAAM,yGAAE,CAAC,SAAS,CAAC,eAAe,KAAK,SAAS,CAAC,MAAM,MAAM,IAAI;AACnE;AAEA,MAAM,WAAW,CAAC,QAChB,OAAO,UAAU,YAAY,UAAU,QAAQ,CAAC,MAAM,OAAO,CAAC;AAEzD,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,IAAA,+IAAkB;QACnC,MAAM,SAAS,AAAC,MAAM,sBAAuB,CAAC;QAC9C,MAAM,WAAW;YAAE,GAAG,QAAQ;QAAC;QAE/B,KAAK,MAAM,OAAO,0IAAa,CAAE;YAC/B,IAAI,MAAM,CAAC,IAAI,EAAE;gBACf,QAAQ,CAAC,IAAmB,GAAG,MAAM,CAAC,IAAI;YAC5C;QACF;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qCAAqC;QACnD,OAAO,+QAAY,CAAC,IAAI,CAAC,IAAA,+IAAkB;IAC7C;AACF;AAEO,eAAe,MAAM,OAAgB;IAC1C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,MAAM,MAAM;QAClB,MAAM,cAAc,MAAM;QAE1B,IAAI,CAAC,OAAO,gBAAgB,WAAW;YACrC,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,IAAI,CAAC,0IAAa,CAAC,QAAQ,CAAC,MAAM;YAChC,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,WAAW,IAAA,+IAAkB;QACnC,MAAM,SAAU,AAAC,MAAM,sBAAuB,CAAC;QAC/C,MAAM,SAA2B;YAAE,GAAG,QAAQ;YAAE,GAAG,MAAM;QAAC;QAC1D,MAAM,eAAe,MAAM,CAAC,IAAI;QAChC,MAAM,YACJ,SAAS,iBAAiB,SAAS,eAAe;YAAE,GAAG,YAAY;YAAE,GAAG,WAAW;QAAC,IAAI;QAE1F,MAAM,OAAyB;YAAE,GAAG,MAAM;YAAE,CAAC,IAAI,EAAE;QAA0C;QAC7F,MAAM,kBAAkB;QAExB,OAAO,+QAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACF"}}]
}